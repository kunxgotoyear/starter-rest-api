const myModalEl=document.getElementById("modalAlert"),modal=new mdb.Modal(myModalEl,{backdrop:"static",keyboard:!1,focus:!0});modal.show();const instance=mdb.Toast.getInstance(document.getElementById("placement-example-toast"));(this.Notif=(t=>({update:()=>{t.update({stacking:!0,hidden:!0,width:"375px",position:"top-right",autohide:!0,delay:3e3})},show:({...e})=>{e.status?t.update({color:"light"}):t.update({color:"danger"}),document.getElementById("placement-example-toast").children[1].textContent=e.content,t.show()},hide:()=>{t.hide()}})))(instance).update(),$(document).ready(async function(){const t=document.querySelector(".rating");let e=new mdb.Rating(t);if(t){const o=document.querySelectorAll("[data-mdb-original-title]");o.forEach(t=>{t.addEventListener("click",t=>{modal.show(),$.ajax({type:"POST",url:"/api/rating?Content-Type=application/json&Charset=UTF-8",data:{rating:t.target.dataset.ratingValue},dataType:"json",success:function(t){console.log(t),modal.hide()},error:function(t){console.log(t)}})})}),modal.show(),$.ajax({type:"GET",url:"/api/rating?Content-Type=application/json&Charset=UTF-8&uid=true",dataType:"json",success:function(o){console.log(o.content.rating),e.dispose(),e=new mdb.Rating(t,{value:o.content.rating})},error:function(t){console.log(t)}})}$.ajax({type:"POST",url:"/auth/status?Content-Type=application/json&Charset=UTF-8",dataType:"json",success:function(t){console.log(t),modal.hide()},error:function(t){console.log(t);const e=t.responseJSON;if(!1===e.status&&e.content.toLowerCase().includes("register"))switch(location.pathname){case"/login.html":case"/register.html":modal.hide();break;default:location.href="/login.html",modal.hide()}else if(!1===e.status){switch(location.pathname.replace(".html","")){case"/login":case"/register":case"/index":case"/":window.location.replace("main.html"),modal.hide();break;default:modal.hide()}}}}),$("[data-form-forgot]").submit(t=>{t.preventDefault();const e=new FormData(t.target),o=Object.fromEntries(e);modal.show(),$.ajax({type:"POST",url:"/auth/login?Content-Type=application/json&Charset=UTF-8",data:o,dataType:"json",success:function(t){modal.hide(),Notif(instance).show(t),window.location.replace("main.html")},error:function(t){modal.hide(),Notif(instance).show(t.responseJSON)}})}),$("[data-form-login]").submit(t=>{t.preventDefault();const e=new FormData(t.target),o=Object.fromEntries(e);modal.show(),$.ajax({type:"POST",url:"/auth/login?Content-Type=application/json&Charset=UTF-8",data:o,dataType:"json",success:function(t){modal.hide(),Notif(instance).show(t),window.location.replace("main.html")},error:function(t){modal.hide(),Notif(instance).show(t.responseJSON)}})}),$("[data-form-register]").submit(t=>{t.preventDefault();const e=new FormData(t.target),o=Object.fromEntries(e);modal.show(),$.ajax({type:"POST",url:"/auth/register?Content-Type=application/json&Charset=UTF-8",data:o,dataType:"json",success:function(t){console.log(t),modal.hide(),Notif(instance).show(t),window.location.replace("login.html")},error:function(t){console.log(t),modal.hide(),Notif(instance).show(t.responseJSON)}})}),$("[data-button-logout]").click(t=>{t.preventDefault(),$.ajax({type:"PUT",url:"/auth/logout?Content-Type=application/json&Charset=UTF-8",dataType:"json",success:function(t){modal.hide(),Notif(instance).show(t),window.location.replace("login.html")},error:function(t){modal.hide(),Notif(instance).show(t.responseJSON)}})})});